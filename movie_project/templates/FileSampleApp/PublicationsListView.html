{% extends "base_page.html" %}{% load staticfiles %}{% load django_bootstrap_breadcrumbs %}{% block breadcrumbs %}    {{ block.super }}    {% breadcrumb "Publicaciones" "publications_index" %}{% endblock %}{% block title %}Publicaciones{% endblock %}{% block breadcrumbsZone %}{% render_breadcrumbs %}{% endblock %}{% block content %}	<!-- security section -->	{% include 'Security/RolTrabajador.html' %}	<!-- security section -->		<!-- CSS required to bootstrap-notify -->	<!-- <link rel="stylesheet" type="text/css" href="{% static 'bootstrap-notify-master/css/bootstrap-notify.css' %}" />	<link rel="stylesheet" type="text/css" href="{% static 'bootstrap-notify-master/css/styles/alert-bangtidy.css' %}" />	<link rel="stylesheet" type="text/css" href="{% static 'bootstrap-notify-master/css/styles/alert-blackgloss.css' %}" /> -->	<!-- CSS required to bootstrap-notify -->		<!-- CSS required to notifIt -->	<script src="{% static 'notifIt/js/notifIt.js' %}" type="text/javascript"></script>    <link href="{% static 'notifIt/css/notifIt.css' %}" type="text/css" rel="stylesheet">	<!-- CSS required to notifIt -->	    <h1 align="left"><img id="pdfImage" src="{% static "img/Publicacion.png" %}" width="70" height="70" style="margin-bottom:-5px" /> Publicaciones</h1>            {% if messages %}        <!-- <div class="alert alert-success">        <button type="button" class="close" data-dismiss="alert">&times;</button>        <h4>Warning!</h4> -->            {% for message in messages %}            {% if message.tags %}{% endif %}                {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}Important: {% endif %}				<script type='text/javascript'>					var msg = "{{ message }}";					Utils.notifyInfoWithNotifIt(msg);				</script>            {% endfor %}        <!-- </div> -->        {% endif %}    <div>    <div style="float:left;margin-left:-10px" class="navbar-form pull-left">    <label>Búsqueda:</label>     <input id="filter" type="text" class="textinput textInput form-control form-control"/>    </div>       <div id="options" style="margin-left:822px;margin-bottom:15px">    <table>        <th>            <a href="#">            <img id="pdf" src="{% static "img/699434-icon-70-document-file-pdf-32.png" %}" />            </a>        </th>        <th>            <a href="#">            <img id="excel" src="{% static "img/698375-icon-96-document-file-xls-32.png" %}" />            </a>        </th>        <th>            <a class="js-open-modal" href="#" data-modal-id="popupPublicacion">                <img id="search" src="{% static "img/698852-icon-124-printer-text-32.png" %}" />            </a>         </th>    </table>    </div>      </div>      <div id="popupPublicacion" class="modal-box">      <header> <a href="#" class="js-modal-close close">×</a>        <h3><img id="search" src="{% static "img/699347-icon-74-document-search-32.png" %}" /> Búsqueda de publicaciones</h3>      </header>      <div class="modal-body">        <form method="get" class="navbar-form pull-left">            <label for="id_q">Especifique criterio de búsqueda:</label>            <input type="text" name="q" id="id_q" class="textinput textInput form-control form-control span8"><input type="hidden" name="order_by" id="id_order_by">            <input type="button" value="Buscar" class="btn btn-small" id="post-form">        </form>      </br></br></br>      <div id="loading" style="margin-left:23%;display:none">          <div style="float:left"><img id="search" src="{% static "img/progress.gif" %}" /> </div>          <div><p>Búsqueda en ejecución, espere unos segundos por favor</p></div>      </div>      </br>      <div id="searchResults" style="margin-left:15px;;display:none">Hola</div>      <div id="searchResultsBody" class="well" style="margin-left:15px;;display:none"></div>      </div>      <footer> <a href="#" class="btn btn-small js-modal-close">Cancelar</a> </footer>    </div>      <div class="table-responsivesss">     <table id="publicationsList" class="table table-striped table-hover table-condensed footable" data-page-size="4" data-filter="#filter" data-filter-text-only="true">    <thead>        <tr>            <th data-toggle="true">Titulo</th>            <!-- <th>Autor</th>    		<th >Nivel de autoria</th> -->            <th >Año</th>            <th >Pais</th>            <th >Ciudad</th>			<th data-hide="phone,tablet">Autores</th>            <th data-hide="phone,tablet">Editorial</th>            <th data-hide="phone,tablet">Publicacion</th>            <th data-hide="phone,tablet">Número</th>            <th data-hide="phone,tablet">Volumen</th>            <th data-hide="phone,tablet">Nivel MES</th>            <th data-hide="phone,tablet">Aprobación</th>            <th data-hide="phone,tablet">Fichero</th>        </tr>    </thead>    {% for item in publications %}        <tr>            <td><span class="footable-toggle"></span><a href="PublicacionView/{{ item.id }}">{{ item.titulo }}</a></td>            <!-- <td>{{ item.autor }}</td>            <td>{{ item.nivel_autoria }}</td> -->            <td>{{ item.anno }}</td>            <td>{{ item.pais }}</td>            <td>{{ item.ciudad }}</td>			<td>				{% for autor in item.autores.all %}					<img src="{% static 'img/avatar.png' %}" width=20px height=20px> {{ autor.first_name }} {{ autor.last_name }}</br>				{% endfor %}			</td>            <td>{{ item.editorial }}</td>            <td>{{ item.publicacion }}</td>            <td>{{ item.numero }}</td>            <td>{{ item.volumen }}</td>            <td>{{ item.nivel_mes }}</td>            <td>			{% if item.aprobacion == False %}				No aprobada			{% else %}				Aprobada			{% endif %}			</td>            <td><a href={{ item.fichero.url }}><img src="{% static 'img/699329-icon-57-document-download-32.png' %}" /></a></td>        </tr>		{% empty %}            {% if user.is_authenticated %}            <div class="alert alert-info">                <p>Opps {{ user.username }}, no existen publicaciones a listar creadas por usted.</p>            </div>        {% endif %}    {% endfor %}	<tfoot>        <tr>            <td colspan="5">                <div class="pagination pagination-centered"></div>            </td>            <td colspan="5">                            </td>        </tr>    </tfoot>    </table>	</div>{% if is_paginated %}    <div class="pagination">    <span class="step-links">        {% if page_obj.has_previous %}            <a href="?page={{ page_obj.previous_page_number }}">previous</a>        {% endif %}        <span class="current">            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.        </span>n        {% if page_obj.has_next %}            <a href="?page={{ page_obj.next_page_number }}">next</a>        {% endif %}    </span>    </div>{% else %}    {% endif %}        <!-- Modal -->    <div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">    </div><!-- /.modal -->        <div>        <div style="float:left;margin-top:-5px">            <div class="pagination pagination-centered"></div>        </div>        <div style="float:right">            <button class="btn" id="create-publication" href="{% url 'pub_create' %}" type="submit"><img src="{% static "img/698913-icon-81-document-add-32.png" %}" />| Crear publicación            </button>            <button class="btn" id="edit-publication" type="submit"><img src="{% static "img/698873-icon-136-document-edit-32.png" %}" />| Editar publicación</button>            <button class="btn" id="delete-publication" type="submit"><img src="{% static "img/698910-icon-79-document-cancel-32.png" %}" />| Eliminar publicación</button>        </div>        </div>        </div>	<!-- <div class='notifications bottom-left'></div> -->	<!-- Placed at the end of the document so the pages load faster -->	<!-- <script src="{% static 'bootstrap-notify-master/js/prettify.js' %}"></script>	<script src="{% static 'bootstrap-notify-master/js/bootstrap-transition.js' %}"></script>	<script src="{% static 'bootstrap-notify-master/js/bootstrap-alert.js' %}"></script>	<script src="{% static 'bootstrap-notify-master/js/bootstrap-notify.js' %}"></script> -->	<script type="text/javascript">   $(function() {    var url;    $('.footable').footable({                            toggleHTMLElement: '<span><img src="{% static "img/expand-128.png" %}" class="footable-toggle footable-expand" border="0" alt="Expand" width=16px height=16px><img src="{% static "img/collapse-128.png" %}" class="footable-toggle footable-contract" border="0" alt="Contract" width=16px height=16px></span>'                            });    // Deshabilitamos los botones de edición y eliminación    Utils.disableButtons("edit-publication", "delete-publication")    // Manejamos el evento click de la tabla que contiene el listado de publicaciones, en este evento click asignamos a la variable global "window.selectedItemId" el id de la tupla seleccionada    Utils.table_tr_click("publicationsList", "edit-publication", "delete-publication");    // Manejamos el evento click del button modificar    //Utils.edit_click("edit-publication", "publication_edit");    // Super Simple Modal Popup section    Utils.DisplayPopup();    //Habilitamos/Deshabilitamos el button de búsqueda en dependencia del value del campo de búsqueda    //Utils.Enable_DisableSearchButton();    // Footable    Utils.footable();	$('#create-publication').click(function()     {        url = "{% url 'pub_create' %}";        window.location = url;        //alert(url);    });    $('#edit-publication').click(function()     {        url = "{% url 'publication_edit' 12345 %}".replace(/12345/, window.selectedItemId);        window.location = url;        //alert(url);    });    $('#delete-publication').click(function()     {        url = "{% url 'publication_delete' 12345 %}".replace(/12345/, window.selectedItemId);        window.location = url;    });    $('#post-form').click(function()     {        //Mostramos el indicador "cargando"        $('#loading').show();        // Ocultamos, en el caso de estar visible, el div que muestra los resultados de la búsqueda        $('#searchResults').hide();        $('#searchResultsBody').hide();        //Ejecutamos mediante ajax, pasados unos segundos, el post que envia la query de búsqueda        setTimeout(function() {            Utils.testingAjax($("#id_q").val());        }, 3000);    });    $('#pdf').click(function()     {		if({{ publications.count }} > 0 )			{			window.open("PublicacionesPdf/");		}		else				{			Utils.notifyWithNotifIt();		}    });    $('#excel').click(function()     {		if({{ publications.count }} > 0 )			{			window.open("publicacionesCSV/");		}		else				{			Utils.notifyWithNotifIt();		}    });});</script>{% endblock %}