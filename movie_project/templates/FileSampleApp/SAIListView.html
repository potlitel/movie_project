{% extends "base_page.html" %}{% load staticfiles %}{% load django_bootstrap_breadcrumbs %}{% block breadcrumbs %}    {{ block.super }}    {% breadcrumb "Servicios Academico-Investigativos" "sais_index" %}{% endblock %}{% block title %}Servicios Academico-Investigativos{% endblock %}{% block breadcrumbsZone %}{% render_breadcrumbs %}{% endblock %}{% block content %}		<!-- security section -->	{% include 'Security/RolTrabajador.html' %}	<!-- security section -->		<!-- CSS required to notifIt -->	<script src="{% static 'notifIt/js/notifIt.js' %}" type="text/javascript"></script>    <link href="{% static 'notifIt/css/notifIt.css' %}" type="text/css" rel="stylesheet">	<!-- CSS required to notifIt -->		<p class="Track" align="left"><img id="pdfImage" src="{% static "img/SAI.png" %}" width="70" height="70" style="margin-bottom:-5px" /> Servicios Académicos Investigativos</p>	        {% if messages %}        <!-- <div class="alert alert-success">        <button type="button" class="close" data-dismiss="alert">&times;</button>        <h4>Warning!</h4> -->            {% for message in messages %}            {% if message.tags %}{% endif %}                {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}Important: {% endif %}				<script type='text/javascript'>					var msg = "{{ message }}";					Utils.notifyInfoWithNotifIt(msg);				</script>            {% endfor %}        <!-- </div> -->        {% endif %}    <div>    <div style="float:left;margin-left:-10px" class="navbar-form pull-left">    <label>Búsqueda:</label>     <input id="filter" type="text" class="textinput textInput form-control form-control"/>    </div>           <div id="options" style="margin-left:822px;margin-bottom:15px">    <table>        <th>            <a href="#" class="show-notification">            <img id="pdf" src="{% static 'img/699434-icon-70-document-file-pdf-32.png' %}" />            </a>        </th>        <th>            <a href="#">            <img id="excel" src="{% static 'img/698375-icon-96-document-file-xls-32.png' %}" />            </a>        </th>        <th>            <a class="js-open-modal" href="#" data-modal-id="popupNoticia">                <img id="search" src="{% static 'img/698852-icon-124-printer-text-32.png' %}" />            </a>         </th>    </table>    </div>      </div>      <div id="popupNoticia" class="modal-box">      <header> <a href="#" class="js-modal-close close">×</a>        <h3><img id="search" src="{% static "img/699347-icon-74-document-search-32.png" %}" /> Búsqueda de noticias</h3>      </header>      <div class="modal-body">        <form method="get" class="navbar-form pull-left">            <label for="id_q">Especifique criterio de búsqueda:</label>            <input type="text" name="q" id="id_q" class="textinput textInput form-control form-control span8"><input type="hidden" name="order_by" id="id_order_by">            <input type="button" value="Buscar" class="btn btn-small" id="post-form">        </form>        </br></br></br>      <div id="loading" style="margin-left:23%;display:none">          <div style="float:left"><img id="search" src="{% static "img/progress.gif" %}" /> </div>          <div><p>Búsqueda en ejecución, espere unos segundos por favor</p></div>      </div>      </br>      <div id="searchResults" style="margin-left:15px;;display:none">Hola</div>      <div id="searchResultsBody" class="well" style="margin-left:15px;;display:none"></div>      </div>      <footer> <a href="#" class="btn btn-small js-modal-close">Cancelar</a> </footer>    </div>                             <div class="table-responsivess">     <table id="saisList" class="table table-striped table-hover table-condensed footable" data-page-size="4" data-filter="#filter" data-filter-text-only="true">    <thead>    <tr>        <th data-toggle="true">Area solicitante</th>        <th>Fecha</th>		<th>Código</th>        <th>Tipo SAI</th>		<th>SubTipo SAI</th>        <th data-hide="phone,tablet">Cantidad de personas a recibir el servicio solicitado</th>        <th data-hide="phone,tablet">Temática del servicio solicitado</th>        <th data-hide="phone,tablet">Tiempo estimado de duración del servicio solicitado</th>		<th data-hide="phone,tablet">Descripción</th>		<th data-hide="phone,tablet">Ejecutores</th>		<th data-hide="phone,tablet">Aprobación</th>		<th data-hide="phone,tablet">Evaluación</th>    </tr>    </thead>    <!--Este listado deber ser filtrado por propietario (logued user)-->    {% for item in sais %}        <tr>            <td><a href="SAIView/{{ item.id }}">{{ item.area_solicitante }}</a></td>            <td>{{ item.fecha }}</td>            <td>{{ item.codigo }}</td>            <td>{{ item.tipo_SAI }}</td>			<td>{{ item.subtipo_SAI }}</td>			<td>{{ item.personal_SAI }}</td>			<td>{{ item.tematica_SAI }}</td>			<td>{{ item.tiempo_SAI }}</td>			<td>{{ item.descripcion_SAI }}</td>            <td>				{% for ejecutor in item.ejecutores.all %}					<img src="{% static "img/avatar.png" %}" width=20px height=20px> {{ ejecutor.first_name }} {{ ejecutor.last_name }}</br>				{% endfor %}			</td>			<td>				{% if item.aprobacion == False %}					No aprobado				{% else %}					Aprobado</br>					Aprobador: {{ item.aprobador_SAI.first_name }} {{ item.aprobador_SAI.last_name }} </br>					Cargo de Aprobador: {{ item.aprobador_cargo_SAI }} </br>					Responsable de la ejecucion: {{ item.responsable_ejecucion_SAI.first_name }} {{ item.responsable_ejecucion_SAI.first_name }} </br>					{% if item.comentario_SAI_No_Aprobacion %}					Motivos de desaprobacion: {{ item.comentario_SAI_No_Aprobacion }}</br>					{% endif %}									{% endif %}				<p></p>			</td>			<td>				{% if item.evaluacion_SAI %}					{{ item.evaluacion_SAI }}</br>					Comentario de la evaluacion: {{ item.comentario_SAI_evaluacion }}				{% elif not item.evaluacion_SAI and item.aprobacion == True %}					No ha sido evaluado aun.				{% else %}					Requiere aprobacion previa				{% endif %}								</td>        </tr>		{% empty %}            {% if user.is_authenticated %}            <div class="alert alert-info">                <p>Opps {{ user.username }}, no existen servicios SAI a listar solicitados por usted.</p>            </div>        {% endif %}    {% endfor %}	<tfoot>                        <tr>                            <td colspan="5">                                <div class="pagination pagination-centered"></div>                            </td>                        </tr>                    </tfoot>    </table>	</div>        <div>        <div style="float:left;margin-top:-5px">            <div class="pagination pagination-centered"></div>        </div>        <div style="float:right">            <button class="btn" id="create-noticia" href="" type="submit"><img src="{% static "img/698913-icon-81-document-add-32.png" %}" />| Crear SAI            </button>            <button class="btn" id="edit-noticia" type="submit"><img src="{% static "img/698873-icon-136-document-edit-32.png" %}" />| Editar SAI</button>			<button class="btn" id="aprobar-sai" type="submit"><img src="{% static "img/698873-icon-136-document-edit-32.png" %}" />| Aprobar SAI</button>			<button class="btn" id="evaluar-sai" type="submit"><img src="{% static "img/698873-icon-136-document-edit-32.png" %}" />| Evaluar SAI</button>            <button class="btn" id="delete-noticia" type="submit"><img src="{% static "img/698910-icon-79-document-cancel-32.png" %}" />| Eliminar SAI</button>        </div>        </div>        </div>		        <!-- <div class='notifications bottom-left'></div> -->    	<!-- Placed at the end of the document so the pages load faster -->	<!-- <script src="{% static 'bootstrap-notify-master/js/prettify.js' %}"></script>	<script src="{% static 'bootstrap-notify-master/js/bootstrap-transition.js' %}"></script>	<script src="{% static 'bootstrap-notify-master/js/bootstrap-alert.js' %}"></script>	<script src="{% static 'bootstrap-notify-master/js/bootstrap-notify.js' %}"></script>  -->		<script type='text/javascript'>   $(function() {			var url;    $('.footable').footable({                            toggleHTMLElement: '<span><img src="{% static 'img/expand-128.png' %}" class="footable-toggle footable-expand" border="0" alt="Expand" width=16px height=16px><img src="{% static "img/collapse-128.png" %}" class="footable-toggle footable-contract" border="0" alt="Contract" width=16px height=16px></span>'                            });    // Deshabilitamos los botones de edición y eliminación    Utils.disableButtonsSAI('edit-noticia', 'delete-noticia', 'aprobar-sai', 'evaluar-sai')    // Manejamos el evento click de la tabla que contiene el listado de noticias, en este evento click asignamos a la variable global "window.selectedItemId" el id de la tupla seleccionada    Utils.table_tr_clickSAI("saisList", "edit-noticia", "delete-noticia", "aprobar-sai", "evaluar-sai");    // Super Simple Modal Popup section    Utils.DisplayPopup();    // Footable    Utils.footable();		$("#saisList tr").click(function()     {       aprobacion = $(this).find("p").value;	   <!-- alert(aprobacion); -->    });		$('#create-noticia').click(function()     {        url = "{% url 'SAI_create' %}";        window.location = url;        //alert(url);    });	    $('#edit-noticia').click(function()     {        url = "{% url 'sai_edit' 12345 %}".replace(/12345/, window.selectedItemId);        window.location = url;    });		$('#aprobar-sai').click(function()     {        url = "{% url 'sai_editAprobacion' 12345 %}".replace(/12345/, window.selectedItemId);        window.location = url;    });		$('#evaluar-sai').click(function()     {        url = "{% url 'sai_editEvaluacion' 12345 %}".replace(/12345/, window.selectedItemId);        window.location = url;    });    $('#delete-noticia').click(function()     {        url = "{% url 'sai_delete' 12345 %}".replace(/12345/, window.selectedItemId);        window.location = url;    });    $('#post-form').click(function()     {        //Mostramos el indicador "cargando"        $('#loading').show();        // Ocultamos, en el caso de estar visible, el div que muestra los resultados de la búsqueda        $('#searchResults').hide();        $('#searchResultsBody').hide();        //Ejecutamos mediante ajax, pasados unos segundos, el post que envia la query de búsqueda        setTimeout(function() {            Utils.searchNew($("#id_q").val());        }, 3000);    });    $('#pdf').click(function()     {		if({{ sais.count }} > 0 )			{			window.open('SAIPdf/');		}		else				{				Utils.notifyWithNotifIt();				/*$('.bottom-left').notify({				  message: 'Listado vacío, un reporte debe contener al menos un registro',				  type: 'blackgloss',				  fadeOut: {					delay: Math.floor(Math.random() * 500) + 2500				  }				}).show();*/		}    });    $('#excel').click(function()     {		if({{ sais.count }} > 0 )			{			window.open("SAICSV/");		}		else				{			Utils.notifyWithNotifIt();			//Utils.DisplayMessageEmptyList();		}    });});</script>{% endblock %}